/* Path: Public/assets/css/mat_stats_print.css
 * 說明: 統計頁列印（只印 A-F 表格內容）
 * 需求：
 * 1) A4 橫式
 * 2) 列印抬頭：LOGO + 境宏工程有限公司領退料統計（放進 table thead，跨頁重複）
 * 3) 每一班從新的一頁開始
 * 4) 頁碼：放棄（不做）
 */

@page {
  size: A4 landscape;
  margin: 10mm 5mm;
}

@media print {
  /* 顏色盡量保留（仍需使用者列印選擇彩色/背景） */
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  html,
  body {
    background: #fff !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* 先把整頁都隱藏 */
  body * {
    visibility: hidden !important;
  }

  /* 只讓列印區可見 */
  #msPrintArea,
  #msPrintArea * {
    visibility: visible !important;
  }

  /* 列印區定位到頁面左上 */
  #msPrintArea {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    width: auto;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* ===== 列印：取消圓角 + 取消陰影 + 取消非表格框線 ===== */
  #msPrintArea .card,
  #msPrintArea .ms-section,
  #msPrintArea .ms-table-wrap {
    border-radius: 0 !important;
    box-shadow: none !important;
    border: 0 !important;
    outline: 0 !important;
  }

  /* 班別卡片原本的 head/body 也不要框線 */
  #msPrintArea .ms-section__head,
  #msPrintArea .ms-section__body {
    border: 0 !important;
    box-shadow: none !important;
    outline: 0 !important;
  }

  /* ===== 只有表格要框線 ===== */
  #msPrintArea table {
    width: 100% !important;
    border-collapse: collapse !important;
    border: 1.5px solid #9a9a9a !important;
    border-radius: 0 !important;
  }

  #msPrintArea th,
  #msPrintArea td {
    border: 1.2px solid #9a9a9a !important;
    padding: 6px 8px !important;
    vertical-align: middle;
  }

  /* ✅ thead 跨頁重複（核心） */
  #msPrintArea thead {
    display: table-header-group;
  }

  #msPrintArea tfoot {
    display: table-footer-group;
  }

  /* 避免某些列被切開（注意：太嚴格可能導致大片留白，但通常可接受） */
  #msPrintArea tr,
  #msPrintArea td,
  #msPrintArea th {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* 每一班（每個 .ms-section）從新的一頁開始 */
  #msPrintArea .ms-section {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  #msPrintArea .ms-section:not(:first-of-type) {
    break-before: page !important;
    page-break-before: always !important;
  }

  /* ===== 列印抬頭（插在 thead 的第一列） =====
     這一列本身：不要格線（你要求只有表格格線，抬頭不要框線）
  */
  #msPrintArea tr.ms-print-thead th.ms-print-thead-cell {
    border: 0 !important;
    padding: 0 0 8px 0 !important;

    /* 1) 標題靠左：避免 th 預設置中 */
    text-align: left !important;

    /* 2) 遮掉抬頭區的 table 外框線（上/左/右） */
    position: relative !important;
    background: #fff !important;
  }

  /* 遮掉抬頭區上/左/右三條外框線（你紅線那三條） */
  #msPrintArea tr.ms-print-thead th.ms-print-thead-cell::before {
    content: "";
    position: absolute;
    top: -3px; /* 蓋住上框線 */
    left: -3px; /* 蓋住左框線 */
    right: -3px; /* 蓋住右框線 */
    bottom: 0; /* 不往下蓋到下一列表頭 */
    background: #fff;
    z-index: 0;
  }

  /* 讓抬頭內容浮在白底遮罩上 */
  #msPrintArea .ms-print-thead-wrap {
    position: relative;
    z-index: 1;

    display: flex !important;
    align-items: center !important;
    gap: 10px !important;
    padding: 0 0 8px 0 !important;

    /* 3) 抬頭底下那條線取消：不加任何 border-bottom */
    border-bottom: 0 !important;
  }

  #msPrintArea .ms-print-logo {
    width: 40px !important;
    height: 40px !important;
    object-fit: contain !important;
  }

  #msPrintArea .ms-print-title {
    font-size: 16px !important;
    font-weight: 700 !important;
    margin: 0 !important;
    line-height: 1.2 !important;
  }

  #msPrintArea .ms-print-meta {
    font-size: 12px !important;
    color: #444 !important;
    margin-top: 4px !important;
  }

  /* 只縮小：B班的「筆數」欄位（列印專用） */
  #msPrintArea table.ms-table--b td.ms-td-count {
    font-size: 12px !important; /* 你要多小再調 */
  }
}
