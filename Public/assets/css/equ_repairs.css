/* Path: Public/assets/css/equ_repairs.css
 * 說明: 工具管理｜維修/保養/購買/租賃（列表 + 新增/編輯 modal）
 * 目標：版型比照 Public/assets/css/car_repairs.css
 * - 移除舊的 toolbar / panel / table-wrap 版型依賴（頁面已改成 equ-shell + equ-head + equ-caps + equ-body）
 * - 保留/延續既有 modal / 明細區塊樣式（equ-modal / equ-items / equ-grid）
 */

/* ===== Page shell (match car) ===== */
.equ-repairs .equ-shell {
  padding: 0;
}

.equ-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 14px 16px;
  border-bottom: 1px solid var(--line-2);
}

.equ-kpi {
  display: inline-flex;
  align-items: baseline;
  gap: 8px;
  padding: 8px 10px;
  border: 1px solid var(--line-2);
  border-radius: 14px;
  background: rgba(255, 255, 255, 0.72);
}

.equ-kpi__label {
  font-size: 13px;
  color: var(--muted);
  font-weight: 700;
}

.equ-kpi__value {
  font-size: 18px;
  font-weight: 900;
  color: rgba(15, 23, 42, 0.92);
}

/* ===== Capsules (match car cr-caps) ===== */
.equ-caps {
  margin-top: 10px;
  padding: 10px 16px 0 16px; /* 與 equ-body 左右對齊 */
}

.equ-caps__list {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
}

.equ-cap {
  appearance: none;
  border: 1px solid var(--line-2);
  background: rgba(255, 255, 255, 0.86);
  color: rgba(15, 23, 42, 0.86);
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 13px;
  font-weight: 800;
  line-height: 1;
  cursor: pointer;
  user-select: none;
}

.equ-cap:hover {
  border-color: rgba(15, 23, 42, 0.2);
  background: rgba(255, 255, 255, 0.96);
}

.equ-cap.is-active {
  border-color: rgba(37, 99, 235, 0.35);
  background: rgba(37, 99, 235, 0.12);
  color: rgba(30, 58, 138, 0.98);
}

.equ-cap__count {
  margin-left: 6px;
  font-variant-numeric: tabular-nums;
  color: rgba(15, 23, 42, 0.55);
}

.equ-cap.is-active .equ-cap__count {
  color: rgba(30, 58, 138, 0.8);
}

.equ-caps__hint {
  margin-top: 6px;
  font-size: 13px;
  color: var(--muted);
}

/* ===== Body / Table wrapper (match car) ===== */
.equ-body {
  padding: 14px 16px 16px 16px;
}

.equ-tableWrap {
  position: relative;
  overflow: auto;
}

.equ-table {
  min-width: 1080px; /* 工具表欄位較少，給個安全值避免擠爆 */
}

/* ===== Table: colgroup widths (match car approach) ===== */
.equ-table {
  table-layout: fixed;
}

/* 項次 */
.equ-table col.equ-col--no {
  width: 4%;
}

/* 日期 */
.equ-table col.equ-col--date {
  width: 12%;
}

/* 類型 */
.equ-table col.equ-col--type {
  width: 10%;
}

/* 工具 */
.equ-table col.equ-col--tool {
  width: 18%;
}

/* 廠商 */
.equ-table col.equ-col--vendor {
  width: 18%;
}

/* 內容摘要 */
.equ-table col.equ-col--summary {
  width: 24%;
}

/* 公司 */
.equ-table col.equ-col--company {
  width: 6%;
}

/* 工班 */
.equ-table col.equ-col--team {
  width: 6%;
}

/* 總額 */
.equ-table col.equ-col--total {
  width: 6%;
}

/* 操作 */
.equ-table col.equ-col--actions {
  width: 10%;
}

/* ===== Cell typography / alignment (match car behavior) ===== */
.equ-table td {
  color: rgba(15, 23, 42, 0.78);
}

.equ-table td.num,
.equ-table th.num {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

.equ-table td.actions {
  text-align: right;
  white-space: nowrap;
}

/* 預設：表頭/內容置中（摘要欄例外靠左） */
.equ-table th,
.equ-table td {
  text-align: center;
  vertical-align: middle;
}

/* 例外：摘要欄靠左（你 JS 渲染 td 時請加 class="summary" 或包 .equ-summary） */
.equ-table td.summary {
  text-align: left;
}

.equ-summary {
  text-align: left;
  color: rgba(15, 23, 42, 0.76);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 520px;
}

/* 空/載入 */
.equ-empty,
.equ-loading {
  padding: 14px 6px 4px 6px;
  color: var(--muted);
  font-size: 14px;
}

/* 整列 hover（match car） */
.equ-table tbody tr {
  transition: background-color 0.15s ease;
}

.equ-table tbody tr:hover {
  background-color: rgba(15, 23, 42, 0.04);
}

.equ-table tbody tr:hover td.num {
  color: #0f172a;
  font-weight: 600;
}

/* ===== Legacy toolbar/panel/table-wrap: keep harmless fallback =====
 * （頁面版型已改成 equ-shell，不再使用 equ-panel / table-wrap / cs-empty）
 * 仍保留 minimal，避免其他舊頁引用時炸掉
 */
.equ-panel {
  padding: 14px;
}

.table-wrap {
  overflow: auto;
  border: 1px solid rgba(15, 23, 42, 0.1);
  border-radius: 14px;
  background: #fff;
}

.ta-r {
  text-align: right;
}

.cs-empty {
  text-align: center;
  color: rgba(15, 23, 42, 0.55);
  padding: 18px !important;
}

/* =========================
   Modal（保留你原本樣式）
   ========================= */

.equ-modal {
  position: fixed;
  inset: 0;
  display: none;
  z-index: 9999;
}

.equ-modal[aria-hidden="false"] {
  display: block;
}

.equ-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(2, 6, 23, 0.55);
}

.equ-modal__panel {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(980px, calc(100vw - 24px));
  max-height: calc(100vh - 24px);
  overflow: hidden;
  border-radius: 18px;
  background: #fff;
  border: 1px solid rgba(15, 23, 42, 0.12);
  box-shadow: 0 30px 80px rgba(2, 6, 23, 0.25);
}

.equ-modal__head,
.equ-modal__foot {
  padding: 12px 14px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.equ-modal__head {
  border-bottom: 1px solid rgba(15, 23, 42, 0.08);
}

.equ-modal__foot {
  border-top: 1px solid rgba(15, 23, 42, 0.08);
  justify-content: flex-end;
}

.equ-modal__body {
  padding: 12px 14px;
  overflow: auto;
  max-height: calc(100vh - 170px);
}

.equ-iconbtn {
  width: 34px;
  height: 34px;
  border-radius: 10px;
  border: 1px solid rgba(15, 23, 42, 0.12);
  background: #fff;
  cursor: pointer;
}

/* 表單欄位（沿用你原本） */
.equ-field {
  display: grid;
  gap: 6px;
  font-size: 13px;
  color: rgba(15, 23, 42, 0.7);
}

.equ-field input,
.equ-field select {
  height: 36px;
  border: 1px solid rgba(15, 23, 42, 0.12);
  border-radius: 10px;
  padding: 0 10px;
  background: #fff;
  color: #0f172a;
}

.equ-field textarea {
  border: 1px solid rgba(15, 23, 42, 0.12);
  border-radius: 10px;
  padding: 10px;
  background: #fff;
  color: #0f172a;
  resize: vertical;
  min-height: 78px; /* 接近車輛備註高度 */
}

.equ-field--grow {
  min-width: 260px;
  flex: 1;
}

.equ-field--full {
  grid-column: 1 / -1;
}

.equ-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 12px;
}

/* 明細區（沿用你原本） */
.equ-items {
  border: 1px solid rgba(15, 23, 42, 0.1);
  border-radius: 14px;
  overflow: hidden;
}

.equ-items__head {
  padding: 10px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(15, 23, 42, 0.03);
}

.equ-items__tablewrap {
  overflow: auto;
  background: #fff;
}

.equ-items__foot {
  padding: 10px 12px;
  border-top: 1px solid rgba(15, 23, 42, 0.08);
  background: rgba(15, 23, 42, 0.02);
}

.equ-sum {
  display: flex;
  gap: 18px;
  justify-content: flex-end;
}

.equ-totals {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
  margin-top: 12px;
}

.equ-totalCard {
  border: 1px solid rgba(15, 23, 42, 0.1);
  border-radius: 14px;
  padding: 12px;
  background: rgba(255, 255, 255, 0.78);
  display: grid;
  gap: 6px;
}

.equ-totalCard__label {
  font-size: 13px;
  color: rgba(15, 23, 42, 0.62);
  font-weight: 800;
}

.equ-totalCard__value {
  text-align: right;
  font-variant-numeric: tabular-nums;
  font-size: 18px;
  font-weight: 900;
  color: rgba(15, 23, 42, 0.92);
}

/* ===== Equ modal：對齊 car 維修 modal 的 crm 版型（只作用在 equ modal） ===== */

/* 讓 equ modal 面板尺寸/滾動行為接近 car（但不依賴 ui_modal.css） */
.equ-modal__panel {
  width: min(1040px, calc(100vw - 48px));
  max-width: 1040px;
  max-height: calc(100vh - 72px);
  display: flex;
  flex-direction: column;
}

/* 讓 body 可捲、footer 固定 */
.equ-modal__body {
  overflow: auto;
  max-height: calc(100vh - 72px - 56px - 64px);
}

/* crm 本體（沿用 car 的視覺語言） */
.equ-modal .crm {
  display: grid;
  gap: 14px;
}

/* 工具版：第一列 4 欄（日期/類型/機具/廠商），備註 full */
.equ-modal .crm-grid.crm-grid--equ {
  display: grid;
  grid-template-columns: 1fr 0.9fr 1.35fr 1.35fr;
  gap: 12px;
}
.equ-modal .crm-grid .crm-field {
  display: grid;
  gap: 6px;
}
.equ-modal .crm-grid .crm-field--full {
  grid-column: 1 / -1;
}

/* items 區塊：同 car */
.equ-modal .crm-items {
  border: 1px solid rgba(15, 23, 42, 0.1);
  border-radius: 16px;
  overflow: hidden;
  background: rgba(255, 255, 255, 0.78);
}
.equ-modal .crm-items__head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 10px 12px;
  border-bottom: 1px solid rgba(15, 23, 42, 0.08);
  background: rgba(15, 23, 42, 0.03);
}
.equ-modal .crm-items__title {
  font-weight: 900;
  font-size: 14px;
  color: rgba(15, 23, 42, 0.86);
}
.equ-modal .crm-items__body {
  padding: 10px 12px 12px 12px;
  display: grid;
  gap: 10px;
}

/* 表頭一次顯示 */
.equ-modal .crm-itemsHeadRow {
  display: grid;
  grid-template-columns: 70px 1fr 160px 160px 44px;
  gap: 10px;
  align-items: center;
  padding: 6px 0 8px 0;
  border-bottom: 1px dashed rgba(15, 23, 42, 0.1);
}
.equ-modal .crm-itemsHeadCell {
  font-size: 13px;
  font-weight: 900;
  color: rgba(15, 23, 42, 0.7);
}

/* 明細列 */
.equ-modal .crm-itemRow {
  display: grid;
  grid-template-columns: 70px 1fr 160px 160px 44px;
  gap: 10px;
  align-items: start;
}

/* seq badge */
.equ-modal .crm-seq {
  height: 38px;
  border-radius: 12px;
  border: 1px solid rgba(15, 23, 42, 0.1);
  background: rgba(255, 255, 255, 0.86);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 900;
  color: rgba(15, 23, 42, 0.78);
  font-variant-numeric: tabular-nums;
}

/* 刪除按鈕（同 car） */
.equ-modal .crm-del {
  height: 38px;
  border-radius: 12px;
  border: 1px solid rgba(190, 18, 60, 0.26);
  background: rgba(190, 18, 60, 0.1);
  color: rgba(136, 19, 55, 0.95);
  cursor: pointer;
}
.equ-modal .crm-del:hover {
  background: rgba(190, 18, 60, 0.14);
}

/* totals 三卡（同 car） */
.equ-modal .crm-totals {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
  padding-top: 6px;
}
.equ-modal .crm-totalCard {
  border: 1px solid rgba(15, 23, 42, 0.1);
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.78);
  padding: 10px 12px;
  display: grid;
  gap: 4px;
}
.equ-modal .crm-totalCard__label {
  font-size: 13px;
  color: rgba(15, 23, 42, 0.6);
  font-weight: 800;
}
.equ-modal .crm-totalCard__value {
  font-size: 18px;
  font-weight: 950;
  letter-spacing: 0.01em;
  font-variant-numeric: tabular-nums;
  text-align: right;
}

/* RWD */
@media (max-width: 980px) {
  .equ-modal .crm-grid.crm-grid--equ {
    grid-template-columns: 1fr 1fr;
  }
  .equ-modal .crm-itemsHeadRow,
  .equ-modal .crm-itemRow {
    grid-template-columns: 60px 1fr 130px 130px 44px;
  }
}
@media (max-width: 680px) {
  .equ-modal .crm-grid.crm-grid--equ {
    grid-template-columns: 1fr;
  }
  .equ-modal .crm-itemsHeadRow {
    display: none;
  }
  .equ-modal .crm-itemRow {
    grid-template-columns: 1fr;
  }
  .equ-modal .crm-seq {
    justify-content: flex-start;
    padding: 0 12px;
  }
  .equ-modal .crm-totals {
    grid-template-columns: 1fr;
  }
}
